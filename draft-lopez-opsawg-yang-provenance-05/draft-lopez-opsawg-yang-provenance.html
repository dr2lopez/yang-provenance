<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Applying COSE Signatures for YANG Data Provenance</title>
<meta content="Diego Lopez" name="author">
<meta content="Antonio Pastor" name="author">
<meta content="Alex Huang Feng" name="author">
<meta content="Ana Mendez" name="author">
<meta content="Henk Birkholz" name="author">
<meta content="Sofia Garcia" name="author">
<meta content="
       This document defines a mechanism based on COSE signatures to provide and verify the provenance of YANG data, so it is possible to verify the origin and integrity of a dataset, even when those data are going to be processed and/or applied in workflows where a crypto-enabled data transport directly from the original data stream is not available. As the application of evidence-based OAM automation and the use of tools such as AI/ML grow, provenance validation becomes more relevant in all scenarios. The use of compact signatures facilitates the inclusion of provenance strings in any YANG schema requiring them. 
    " name="description">
<meta content="xml2rfc 3.27.0" name="generator">
<meta content="provenance" name="keyword">
<meta content="signature" name="keyword">
<meta content="COSE" name="keyword">
<meta content="metadata" name="keyword">
<meta content="draft-lopez-opsawg-yang-provenance-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.27.0
    Python 3.12.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-lopez-opsawg-yang-provenance.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">yang-data-provenance</td>
<td class="right">February 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lopez, et al.</td>
<td class="center">Expires 30 August 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Operations and Management Area Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-lopez-opsawg-yang-provenance-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-02-26" class="published">26 February 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-08-30">30 August 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Lopez</div>
<div class="org">Telefonica</div>
</div>
<div class="author">
      <div class="author-name">A. Pastor</div>
<div class="org">Telefonica</div>
</div>
<div class="author">
      <div class="author-name">A. Huang Feng</div>
<div class="org">INSA-Lyon</div>
</div>
<div class="author">
      <div class="author-name">A. Mendez</div>
<div class="org">Telefonica</div>
</div>
<div class="author">
      <div class="author-name">H. Birkholz</div>
<div class="org">Fraunhofer SIT</div>
</div>
<div class="author">
      <div class="author-name">S. Garcia</div>
<div class="org">UC3M</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Applying COSE Signatures for YANG Data Provenance</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines a mechanism based on COSE signatures to provide and verify the provenance of YANG data, so it is possible to verify the origin and integrity of a dataset, even when those data are going to be processed and/or applied in workflows where a crypto-enabled data transport directly from the original data stream is not available. As the application of evidence-based OAM automation and the use of tools such as AI/ML grow, provenance validation becomes more relevant in all scenarios. The use of compact signatures facilitates the inclusion of provenance strings in any YANG schema requiring them.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://dr2lopez.github.io/yang-provenance/draft-lopez-opsawg-yang-provenance.html">https://dr2lopez.github.io/yang-provenance/draft-lopez-opsawg-yang-provenance.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-lopez-opsawg-yang-provenance/">https://datatracker.ietf.org/doc/draft-lopez-opsawg-yang-provenance/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Operations and Management Area Working Group Working Group mailing list (<span><a href="mailto:opsawg@ietf.org">mailto:opsawg@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/opsawg/">https://mailarchive.ietf.org/arch/browse/opsawg/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/opsawg/">https://www.ietf.org/mailman/listinfo/opsawg/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/dr2lopez/yang-provenance">https://github.com/dr2lopez/yang-provenance</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 30 August 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-defining-provenance-element" class="internal xref">Defining Provenance Elements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-provenance-signature-string" class="internal xref">Provenance Signature Strings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-signature-and-verification-" class="internal xref">Signature and Verification Procedures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-canonicalization" class="internal xref">Canonicalization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-provenance-signature-yang-m" class="internal xref">Provenance-Signature YANG Module</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-enclosing-methods" class="internal xref">Enclosing Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-including-a-provenance-leaf" class="internal xref">Including a Provenance Leaf in a YANG Element</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-including-a-provenance-sign" class="internal xref">Including a Provenance Signature in NETCONF Event Notifications and YANG-Push Notifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-yang-tree-diagram" class="internal xref">YANG Tree Diagram</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-yang-module" class="internal xref">YANG Module</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-including-provenance-as-met" class="internal xref">Including Provenance as Metadata in YANG Instance Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-yang-module-2" class="internal xref">YANG Module</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-including-provenance-in-yan" class="internal xref">Including Provenance in YANG Annotations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-yang-module-3" class="internal xref">YANG Module</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-ietf-xml-registry" class="internal xref">IETF XML Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-yang-module-name" class="internal xref">YANG Module Name</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-appendix-a-examples-of-appl" class="internal xref">Appendix A. Examples of Application of the Different Enclosing Methods</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#appendix-A.1" class="auto internal xref"></a><a href="#name-xml" class="internal xref">XML</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#appendix-A.2" class="auto internal xref"></a><a href="#name-json" class="internal xref">JSON</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#appendix-A.3" class="auto internal xref"></a><a href="#name-cbor" class="internal xref">CBOR</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">OAM automation, generally based on closed-loop principles, requires at least two datasets to be used. Using the common terms in Control Theory, we need those from the plant (the network device or segment under control) and those to be used as reference (the desired values of the relevant data). The usual automation behavior compares these values and takes a decision, by whatever the method (algorithmic, rule-based, an AI model tuned by ML...) to decide on a control action according to this comparison. Assurance of the origin and integrity of these datasets, what we refer in this document as "provenance", becomes essential to guarantee a proper behavior of closed-loop automation.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">When datasets are made available as an online data flow, provenance can be assessed by properties of the data transport protocol, as long as some kind of cryptographic protocol is used for source authentication, with TLS, SSH and IPsec as the main examples. But when these datasets are stored, go through some pre-processing or aggregation stages, or even cryptographic data transport is not available, provenance must be assessed by other means.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The original use case for this provenance mechanism is associated with <span>[<a href="#YANGmanifest" class="cite xref">YANGmanifest</a>]</span>, in order to provide a proof of the origin and integrity of the provided metadata, and therefore the examples in this document use the modules described there, but it soon became clear that it could be extended to any YANG datamodel to support provenance evidence. An analysis of other potential use cases suggested the interest of defining an independent, generally applicable mechanism.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Provenance verification by signatures incorporated in YANG data can be applied to any data processing pipeline, whether they rely on an online flow or use some kind of data store, such as data lakes or time-series databases. The application of recorded data for ML training or validation constitute the most relevant examples of these scenarios.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document provides a mechanism for including digital signatures within YANG data. It applies COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> to make the signature compact and reduce the resources required for calculating it. This mechanism is applicable to any serialization of the YANG data supporting a clear method for canonicalization, but this document considers three base ones: CBOR, JSON and XML.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The term "data provenance" refers to a documented trail accounting for the origin of a piece of data and where it has moved from to where it is presently. The signature mechanism provided here can be recursively applied to allow this accounting for YANG data.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="defining-provenance-elements">
<section id="section-3">
      <h2 id="name-defining-provenance-element">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-defining-provenance-element" class="section-name selfRef">Defining Provenance Elements</a>
      </h2>
<p id="section-3-1">The provenance for a given YANG element <span class="bcp14">MUST</span> be convened by a leaf element, containing the COSE signature bitstring built according to the procedure defined below in this section. The provenance leaf <span class="bcp14">MUST</span> be of type provenance-signature, defined as follows:<a href="#section-3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-2">
<pre>
typedef provenance-signature {
     type binary;
     description
      "The provenance-signature type represents a digital signature
       corresponding to the associated YANG element. The signature is based
       on COSE and generated using a canonicalized version of the
       associated element.";
     reference
      "RFC 9052: CBOR Object Signing and Encryption (COSE): Structures and Process
       draft-lopez-opsawg-yang-provenance";
}
</pre><a href="#section-3-2" class="pilcrow">¶</a>
</div>
<div id="provenance-signature-strings">
<section id="section-3.1">
        <h3 id="name-provenance-signature-string">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-provenance-signature-string" class="section-name selfRef">Provenance Signature Strings</a>
        </h3>
<p id="section-3.1-1">Provenance signature strings are COSE single signature messages with [nil] payload, according to COSE conventions and registries, and with the following structure (as defined by <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>], <a href="https://rfc-editor.org/rfc/rfc9052#section-4.2" class="relref">Section 4.2</a></span>):<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-2">
<pre>
COSE_Sign1 = [
protected /algorithm-identifier, kid, serialization-method/
unprotected /algorithm-parameters/
signature /using as external data the content of the YANG
           (meta-)data without the signature leaf/
]
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">The COSE_Sign1 procedure yields a bitstring when building the signature and expects a bitstring for checking it, hence the proposed type for provenance signature leaves. The structure of the COSE_Sign1 consists of:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">
            <p id="section-3.1-4.1.1">The algorithm-identifier, which <span class="bcp14">MUST</span> follow COSE conventions and registries.<a href="#section-3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.2">
            <p id="section-3.1-4.2.1">The kid (Key ID), to be locally agreed, used and interpreted by the signer and the signature validator. URIs <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> and RFC822-style <span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span> identifiers are typical values to be used as kid.<a href="#section-3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.3">
            <p id="section-3.1-4.3.1">The serialization-method, a string identifying the YANG serialization in use. It <span class="bcp14">MUST</span> be one of the three possible values "xml" (for XML serialization <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span>), "json" (for JSON serialization <span>[<a href="#RFC7951" class="cite xref">RFC7951</a>]</span>) or "cbor" (for CBOR serialization <span>[<a href="#RFC9254" class="cite xref">RFC9254</a>]</span>).<a href="#section-3.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.4">
            <p id="section-3.1-4.4.1">The value algorithm-parameters, which <span class="bcp14">MUST</span> follow the COSE conventions for providing relevant parameters to the signing algorithm.<a href="#section-3.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.5">
            <p id="section-3.1-4.5.1">The signature for the YANG element provenance is being established for, to be produced and verified according to the procedure described below for each one of the enclosing methods for the provenance string described below.<a href="#section-3.1-4.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="signature-and-verification-procedures">
<section id="section-3.2">
        <h3 id="name-signature-and-verification-">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-signature-and-verification-" class="section-name selfRef">Signature and Verification Procedures</a>
        </h3>
<p id="section-3.2-1">To keep a concise signature and avoid the need for wrapping YANG constructs in COSE envelopes, the whole signature <span class="bcp14">MUST</span> be built and verified by means of externally supplied data, as defined in <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>], <a href="https://rfc-editor.org/rfc/rfc9052#section-4.3" class="relref">Section 4.3</a></span>, with a [nil] payload.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The byte strings to be used as input to the signature and verification procedures <span class="bcp14">MUST</span> be built by:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">
            <p id="section-3.2-3.1.1">Selecting the exact YANG content to be used, according to the corresponding enclosing methods.<a href="#section-3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-3.2">
            <p id="section-3.2-3.2.1">Applying the corresponding canonicalization method as described in the following section.<a href="#section-3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="canonicalization">
<section id="section-3.3">
        <h3 id="name-canonicalization">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-canonicalization" class="section-name selfRef">Canonicalization</a>
        </h3>
<p id="section-3.3-1">Signature generation and verification require a canonicalization method to be applied, that depends on the serialization used. According to the three types of serialization defined, the following canonicalization methods <span class="bcp14">MUST</span> be applied:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3-2.1">
            <p id="section-3.3-2.1.1">For CBOR, length-first core deterministic encoding, as defined by <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>.<a href="#section-3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.2">
            <p id="section-3.3-2.2.1">For JSON, JSON Canonicalization Scheme (JCS), as defined by <span>[<a href="#RFC8785" class="cite xref">RFC8785</a>]</span>.<a href="#section-3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.3-2.3">
            <p id="section-3.3-2.3.1">For XML, Exclusive XML Canonicalization 1.0, as defined by <span>[<a href="#XMLSig" class="cite xref">XMLSig</a>]</span>.<a href="#section-3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="provenance-signature-yang-module">
<section id="section-3.4">
        <h3 id="name-provenance-signature-yang-m">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-provenance-signature-yang-m" class="section-name selfRef">Provenance-Signature YANG Module</a>
        </h3>
<p id="section-3.4-1">This module defines a provenance-signature type to be used in other YANG modules.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="breakable sourcecode" id="section-3.4-2">
<pre>&lt;CODE BEGINS&gt; file "ietf-yang-provenance@2024-02-28.yang"

module ietf-yang-provenance {
  yang-version 1.1;
  namespace
    "urn:ietf:params:xml:ns:yang:ietf-yang-provenance";
  prefix iyangprov;

  organization "IETF OPSAWG (Operations and Management Area Working Group)";
  contact
    "WG Web:   &lt;https://datatracker.ietf.org/wg/opsawg/&gt;
     WG List:  &lt;mailto:opsawg@ietf.org&gt;

     Authors:  Alex Huang Feng
               &lt;mailto:alex.huang-feng@insa-lyon.fr&gt;
               Diego Lopez
               &lt;mailto:diego.r.lopez@telefonica.com&gt;
               Antonio Pastor
               &lt;mailto:antonio.pastorperales@telefonica.com&gt;
               Henk Birkholz
               &lt;mailto:henk.birkholz@sit.fraunhofer.de&gt;";

  description
    "Defines a binary provenance-signature type to be used in other YANG
    modules.

    Copyright (c) 2024 IETF Trust and the persons identified as
    authors of the code.  All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, is permitted pursuant to, and subject to the license
    terms contained in, the Revised BSD License set forth in Section
    4.c of the IETF Trust's Legal Provisions Relating to IETF Documents
    (https://trustee.ietf.org/license-info).

    This version of this YANG module is part of RFC XXXX; see the RFC
    itself for full legal notices.";

  revision 2024-02-28 {
    description
      "First revision";
    reference
      "RFC XXXX: Applying COSE Signatures for YANG Data Provenance";
  }

  typedef provenance-signature {
    type binary;
    description
      "The provenance-signature type represents a digital signature
      corresponding to the associated YANG element. The signature is based
      on COSE and generated using a canonicalized version of the
      associated element.";
    reference
      "RFC XXXX: Applying COSE Signatures for YANG Data Provenance";
  }
}

&lt;CODE ENDS&gt;</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="enclosing-methods">
<section id="section-4">
      <h2 id="name-enclosing-methods">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-enclosing-methods" class="section-name selfRef">Enclosing Methods</a>
      </h2>
<p id="section-4-1">Once defined the procedures for generating and verifying the provenance signature string, let's consider how these signatures can be integrated with the associated YANG data by enclosing the signature in the data structure. This document considers four different enclosing methods, suitable for different stages of the YANG schema and usage patterns of the YANG data. The enclosing method defines not only how the provenance signature string is combined with the signed YANG data but also the specific procedure for selecting the specific YANG content to be processed when signing and verifying.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Appendix A includes a set of exmaples of the different enclosing methods, applied to the same YANG fragment, to illustrate their use.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="including-a-provenance-leaf-in-a-yang-element">
<section id="section-4.1">
        <h3 id="name-including-a-provenance-leaf">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-including-a-provenance-leaf" class="section-name selfRef">Including a Provenance Leaf in a YANG Element</a>
        </h3>
<p id="section-4.1-1">This enclosing method requires a specific element in the YANG schema defining the element to be signed (the enclosing element), and thus implies considering provenance signatures when creating the corresponding YANG module, or the update of existing modules willing to support this provenance enclosing method.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">When using this enclosing method, a provenance-signature leaf <span class="bcp14">MAY</span> appear at any position in the enclosing element, but only one such leaf <span class="bcp14">MUST</span> be defined for the enclosing element. If the enclosing element contains other non-leaf elements, they <span class="bcp14">MAY</span> provide their own provenance-signature leaf, according to the same rule. In this case, the provenance-signature leaves in the children elements are applicable to the specific child element where they are enclosed, while the provenance-signature leaf enclosed in the top-most element is applicable to the whole element contents, including the children provenance-signature leaf themselves. This allows for recursive provenance validation, data aggregation, and the application of provenance verification of relevant children elements at different stages of any data processing pipeline.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">The specific YANG content to be processed <span class="bcp14">SHALL</span> be generated by taking the whole enclosing element and eliminiating the leaf containing the provenance signature string.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">As example, let us consider the two modules proposed in <span>[<a href="#YANGmanifest" class="cite xref">YANGmanifest</a>]</span>. For the platform-manifest module, the provenance for a platform would be provided by the optional platform-provenance leaf shown below:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-5">
<pre>
module: ietf-platform-manifest
  +--ro platforms
     +--ro platform* [id]
       +--ro id                      string
       +--ro name?                   string
       +--ro vendor?                 string
       +--ro vendor-pen?             uint32
       +--ro software-version?       string
       +--ro software-flavor?        string
       +--ro os-version?             string
       +--ro os-type?                string
       +--ro platform-provenance?    provenance-signature
       +--ro yang-push-streams
       |  +--ro stream* [name]
       |     +--ro name
       |     +--ro description?
       +--ro yang-library
       + . . .
       .
       .
       .
</pre><a href="#section-4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1-6">For data collections, the provenance of each one would be provided by the optional collector-provenance leaf, as shown below:<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-7">
<pre>
module: ietf-data-collection-manifest
  +--ro data-collections
     +--ro data-collection* [platform-id]
     +--ro platform-id
     |       -&gt; /p-mf:platforms/platform/id
     +--ro collector-provenance?   provenance-signature
     +--ro yang-push-subscriptions
       +--ro subscription* [id]
         +--ro id
         |      sn:subscription-id
         +
         .
         .
         .
     + . . .
     |
     .
     .
     .
</pre><a href="#section-4.1-7" class="pilcrow">¶</a>
</div>
<p id="section-4.1-8">Note how, in the two examples, the element bearing the provenance signature appears at different positions in the enclosing element. And note that, for processing the element for signature generation and verification, the signature element <span class="bcp14">MUST</span> be eliminated from the enclosing element before applying the corresponding canonicalization method.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9">Note that, in application of the recursion mechanism described above, a provenance element could be included at the top of any of the collections, supporting the verification of the provenance of the collection itself (as provided by a specific collector), without interfering with the verification of the provenance of each of the collection elements. As an example, in the case of the platform manifests it would look like:<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-10">
<pre>
module: ietf-platform-manifest
  +--ro platforms
     +--ro platform-collection-provenance? provenance-signature
     +--ro platform* [id]
       +--ro platform-provenance?          provenance-signature
       +--ro id                            string
       +--ro name?                         string
       +--ro vendor?                       string
       + . . .
       .
       .
       .
</pre><a href="#section-4.1-10" class="pilcrow">¶</a>
</div>
<p id="section-4.1-11">Note here that, to generate the YANG content to be processed in the case of the collection the provenance leafs of the indivual elements <span class="bcp14">SHALL NOT</span> be eliminated, as it <span class="bcp14">SHALL</span> be the case when generating the YANG content to be processed for each individual element in the collection.<a href="#section-4.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="including-a-provenance-signature-in-netconf-event-notifications-and-yang-push-notifications">
<section id="section-4.2">
        <h3 id="name-including-a-provenance-sign">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-including-a-provenance-sign" class="section-name selfRef">Including a Provenance Signature in NETCONF Event Notifications and YANG-Push Notifications</a>
        </h3>
<p id="section-4.2-1">The signature mechanism proposed in this document <span class="bcp14">MAY</span> be used with NETCONF Event Notifications <span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span> and YANG-Push <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span> to sign the generated notifications directly from the publisher nodes. The signature is added to the header of the Notification along with the eventTime leaf.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The YANG content to be processed <span class="bcp14">MUST</span> consist of the content of the notificationContent element.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The following sections define the YANG module augmenting the ietf-notification module.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div id="yang-tree-diagram">
<section id="section-4.2.1">
          <h4 id="name-yang-tree-diagram">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-yang-tree-diagram" class="section-name selfRef">YANG Tree Diagram</a>
          </h4>
<p id="section-4.2.1-1">The following is the YANG tree diagram <span>[<a href="#RFC8340" class="cite xref">RFC8340</a>]</span> for the ietf-notification-provenance augmentation within the ietf-notification.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>
module: ietf-notification-provenance

  augment-structure /inotif:notification:
    +-- notification-provenance?   iyangprov:provenance-signature
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-3">And the following is the full YANG tree diagram for the notification.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-4">
<pre>
module: ietf-notification

  structure notification:
    +-- eventTime                             yang:date-and-time
    +-- inotifprov:notification-provenance?   iyangprov:provenance-signature
</pre><a href="#section-4.2.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="yang-module">
<section id="section-4.2.2">
          <h4 id="name-yang-module">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-yang-module" class="section-name selfRef">YANG Module</a>
          </h4>
<p id="section-4.2.2-1">The module augments ietf-notification module <span>[<a href="#I-D.ahuang-netconf-notif-yang" class="cite xref">I-D.ahuang-netconf-notif-yang</a>]</span> adding the signature leaf in the notification header.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<div class="breakable sourcecode" id="section-4.2.2-2">
<pre>&lt;CODE BEGINS&gt; file "ietf-notification-provenance@2024-02-28.yang"

module ietf-notification-provenance {
  yang-version 1.1;
  namespace
    "urn:ietf:params:xml:ns:yang:ietf-notification-provenance";
  prefix inotifprov;

  import ietf-notification {
    prefix inotif;
    reference
      "draft-ahuang-netconf-notif-yang: NETCONF Event Notification YANG";
  }
  import ietf-yang-provenance {
    prefix iyangprov;
    reference
      "RFC XXXX: Applying COSE Signatures for YANG Data Provenance";
  }
  import ietf-yang-structure-ext {
    prefix sx;
    reference
      "RFC 8791: YANG Data Structure Extensions";
  }

  organization "IETF OPSAWG (Operations and Management Area Working Group)";
  contact
    "WG Web:   &lt;https://datatracker.ietf.org/wg/opsawg/&gt;
     WG List:  &lt;mailto:opsawg@ietf.org&gt;

     Authors:  Alex Huang Feng
               &lt;mailto:alex.huang-feng@insa-lyon.fr&gt;
               Diego Lopez
               &lt;mailto:diego.r.lopez@telefonica.com&gt;
               Antonio Pastor
               &lt;mailto:antonio.pastorperales@telefonica.com&gt;
               Henk Birkholz
               &lt;mailto:henk.birkholz@sit.fraunhofer.de&gt;";

  description
    "Defines a binary provenance-signature type to be used in other YANG
    modules.

    Copyright (c) 2024 IETF Trust and the persons identified as
    authors of the code.  All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, is permitted pursuant to, and subject to the license
    terms contained in, the Revised BSD License set forth in Section
    4.c of the IETF Trust's Legal Provisions Relating to IETF Documents
    (https://trustee.ietf.org/license-info).

    This version of this YANG module is part of RFC XXXX; see the RFC
    itself for full legal notices.";

  revision 2024-02-28 {
    description
      "First revision";
    reference
      "RFC XXXX: Applying COSE Signatures for YANG Data Provenance";
  }

  sx:augment-structure "/inotif:notification" {
    leaf notification-provenance {
      type iyangprov:provenance-signature;
      description
        "COSE signature of the content of the Notification for
        provenance verification.";
    }
  }
}

&lt;CODE ENDS&gt;</pre><a href="#section-4.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="including-provenance-as-metadata-in-yang-instance-data">
<section id="section-4.3">
        <h3 id="name-including-provenance-as-met">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-including-provenance-as-met" class="section-name selfRef">Including Provenance as Metadata in YANG Instance Data</a>
        </h3>
<p id="section-4.3-1">Provenance signature strings can be included as part of the metadata in YANG instance data files, as defined in <span>[<a href="#RFC9195" class="cite xref">RFC9195</a>]</span> for data at rest. The augmented YANG tree diagram including the provenance signature is as follows:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3-2">
<pre>
module: ietf-yang-instance-data-provenance
  augment-structure instance-data-set:
    +--provenance-string?   provenance-signature
</pre><a href="#section-4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3-3">The provenance signature string in this enclosing method applies to whole content-data element in instance-data-set, independently of whether those data contain other provenance signature strings by applying other enclosing methods.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">The specific YANG content to be processed <span class="bcp14">SHALL</span> be generated by taking the contents of the content-data element and applying the corresponding canonicalization method.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div id="yang-module-1">
<section id="section-4.3.1">
          <h4 id="name-yang-module-2">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-yang-module-2" class="section-name selfRef">YANG Module</a>
          </h4>
<span class="break"></span><dl class="dlParallel" id="section-4.3.1-1">
            <dt id="section-4.3.1-1.1">This module defines the provenance signature element to be included as metadata of a YANG data instance.</dt>
            <dd style="margin-left: 1.5em" id="section-4.3.1-1.2">
              <p id="section-4.3.1-1.2.1">YANG module derived from <span>[<a href="#RFC9195" class="cite xref">RFC9195</a>]</span>, named "ietf-yang-instance-data-provenance"<a href="#section-4.3.1-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="including-provenance-in-yang-annotations">
<section id="section-4.4">
        <h3 id="name-including-provenance-in-yan">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-including-provenance-in-yan" class="section-name selfRef">Including Provenance in YANG Annotations</a>
        </h3>
<p id="section-4.4-1">The use of annotations as defined in <span>[<a href="#RFC7952" class="cite xref">RFC7952</a>]</span> seems a natural enclosing method, dealing with the provenance signature string as metadata and not requiring modification of existing YANG schemas.The provenance-string annotation is defined as follows:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.4-2">
<pre>
 md:annotation provenance-string {
       type provenance-signature;
       description
         "This annotation contains a digital signature corresponding
          to the YANG element in which it appears.";
     }
</pre><a href="#section-4.4-2" class="pilcrow">¶</a>
</div>
<p id="section-4.4-3">The specific YANG content to be processed <span class="bcp14">SHALL</span> be generated by eliminating the provenance-string (encoded according to what is described in Section 5 of <span>[<a href="#RFC7952" class="cite xref">RFC7952</a>]</span>) from the element it applies to, before invoking the corresponding canonicalization method. In application of the general recursion principle for provenance signature strings, any other provenance strings within the element to which the provenance-string applies <span class="bcp14">SHALL</span> be left as they appear, whatever the enclosing method used for them.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<div id="yang-module-2">
<section id="section-4.4.1">
          <h4 id="name-yang-module-3">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-yang-module-3" class="section-name selfRef">YANG Module</a>
          </h4>
<p id="section-4.4.1-1">This module defines a metadata annotation to include a provenance signature for a YANG element.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<div class="breakable sourcecode" id="section-4.4.1-2">
<pre>&lt;CODE BEGINS&gt; file "ietf-provenance-annotation@2024-06-30.yang"

module yang-provenance-metadata {
     yang-version 1.1;
     namespace "http://telefonica.com/temporary-ns-yangpmd";
     prefix "ypmd";
     import ietf-yang-types {
       prefix "yang";
     }
     import ietf-yang-metadata {
       prefix "md";
     }
     organization "IETF OPSAWG (Operations and Management Area Working Group)";
     contact
       "WG Web:   &lt;https://datatracker.ietf.org/wg/opsawg/&gt;
        WG List:  &lt;mailto:opsawg@ietf.org&gt;

        Authors: Diego Lopez
                 &lt;mailto:diego.r.lopez@telefonica.com&gt;
                 Alex Huang Feng
                 &lt;mailto:alex.huang-feng@insa-lyon.fr&gt;
                 Antonio Pastor
                 &lt;mailto:antonio.pastorperales@telefonica.com&gt;
                 Henk Birkholz
                 &lt;mailto:henk.birkholz@sit.fraunhofer.de&gt;";
        description
        "Defines a binary provenance-signature type to be used in YANG
         metadata annotations

         Copyright (c) 2024 IETF Trust and the persons identified as
         authors of the code.  All rights reserved.

         Redistribution and use in source and binary forms, with or without
         modification, is permitted pursuant to, and subject to the license
         terms contained in, the Revised BSD License set forth in Section
         4.c of the IETF Trust's Legal Provisions Relating to IETF Documents
         (https://trustee.ietf.org/license-info).

         This version of this YANG module is part of RFC XXXX; see the RFC
         itself for full legal notices.";

     revision 2024-02-28 {
        description
        "First revision";
        reference
        "RFC XXXX: Applying COSE Signatures for YANG Data Provenance";
     }
     md:annotation provenance-string {
       type yang:provenance-signature;
       description
         "This annotation contains the provenance signature for
          the YANG element associated with it";
     }
}

&lt;CODE ENDS&gt;</pre><a href="#section-4.4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.4.1-3">TBD: Provide a final URL for the "ypmd" prefix.<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">The provenance assessment mechanism described in this document relies on COSE <span>[<a href="#RFC9052" class="cite xref">RFC9052</a>]</span> and the deterministic encoding or canonicalization procedures described by <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, <span>[<a href="#RFC8785" class="cite xref">RFC8785</a>]</span> and <span>[<a href="#XMLSig" class="cite xref">XMLSig</a>]</span>. The security considerations made in these references are fully applicable here.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The verification step depends on the association of the kid (Key ID) with the proper public key. This is a local matter for the verifier and its specification is out of the scope of this document. The use of certificates, PKI mechanisms, or any other secure distribution of id-public key mappings is <span class="bcp14">RECOMMENDED</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="ietf-xml-registry">
<section id="section-6.1">
        <h3 id="name-ietf-xml-registry">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ietf-xml-registry" class="section-name selfRef">IETF XML Registry</a>
        </h3>
<p id="section-6.1-1">This document registers the following URIs in the "IETF XML Registry" <span>[<a href="#RFC3688" class="cite xref">RFC3688</a>]</span>:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-2">
<pre>
  URI: urn:ietf:params:xml:ns:yang:ietf-yang-provenance
  Registrant Contact: The IESG.
  XML: N/A; the requested URI is an XML namespace.
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-6.1-3">
<pre>
  URI: urn:ietf:params:xml:ns:yang:ietf-notification-provenance
  Registrant Contact: The IESG.
  XML: N/A; the requested URI is an XML namespace.
</pre><a href="#section-6.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="yang-module-name">
<section id="section-6.2">
        <h3 id="name-yang-module-name">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-yang-module-name" class="section-name selfRef">YANG Module Name</a>
        </h3>
<p id="section-6.2-1">This document registers the following YANG modules in the "YANG Module Names" registry <span>[<a href="#RFC6020" class="cite xref">RFC6020</a>]</span>:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-2">
<pre>
  name: ietf-yang-provenance
  namespace: urn:ietf:params:xml:ns:yang:ietf-yang-provenance
  prefix: iyangprov
  reference: RFC XXXX
</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<div class="alignLeft art-text artwork" id="section-6.2-3">
<pre>
  name: ietf-notification-provenance
  namespace: urn:ietf:params:xml:ns:yang:ietf-notification-provenance
  prefix: inotifprov
  reference: RFC XXXX
</pre><a href="#section-6.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2-4">TBD: Others? At least for the two additional enclosing methods (instance files and annotations)<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ahuang-netconf-notif-yang">[I-D.ahuang-netconf-notif-yang]</dt>
        <dd>
<span class="refAuthor">Feng, A. H.</span>, <span class="refAuthor">Francois, P.</span>, <span class="refAuthor">Graf, T.</span>, and <span class="refAuthor">B. Claise</span>, <span class="refTitle">"YANG model for NETCONF Event Notifications"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ahuang-netconf-notif-yang-05</span>, <time datetime="2024-06-18" class="refDate">18 June 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ahuang-netconf-notif-yang-05">https://datatracker.ietf.org/doc/html/draft-ahuang-netconf-notif-yang-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3688">[RFC3688]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"The IETF XML Registry"</span>, <span class="seriesInfo">BCP 81</span>, <span class="seriesInfo">RFC 3688</span>, <span class="seriesInfo">DOI 10.17487/RFC3688</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3688">https://www.rfc-editor.org/rfc/rfc3688</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5277">[RFC5277]</dt>
        <dd>
<span class="refAuthor">Chisholm, S.</span> and <span class="refAuthor">H. Trevino</span>, <span class="refTitle">"NETCONF Event Notifications"</span>, <span class="seriesInfo">RFC 5277</span>, <span class="seriesInfo">DOI 10.17487/RFC5277</span>, <time datetime="2008-07" class="refDate">July 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5277">https://www.rfc-editor.org/rfc/rfc5277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5322">[RFC5322]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5322">https://www.rfc-editor.org/rfc/rfc5322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6020">[RFC6020]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6020</span>, <span class="seriesInfo">DOI 10.17487/RFC6020</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6020">https://www.rfc-editor.org/rfc/rfc6020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7950">https://www.rfc-editor.org/rfc/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7951">[RFC7951]</dt>
        <dd>
<span class="refAuthor">Lhotka, L.</span>, <span class="refTitle">"JSON Encoding of Data Modeled with YANG"</span>, <span class="seriesInfo">RFC 7951</span>, <span class="seriesInfo">DOI 10.17487/RFC7951</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7951">https://www.rfc-editor.org/rfc/rfc7951</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7952">[RFC7952]</dt>
        <dd>
<span class="refAuthor">Lhotka, L.</span>, <span class="refTitle">"Defining and Using Metadata with YANG"</span>, <span class="seriesInfo">RFC 7952</span>, <span class="seriesInfo">DOI 10.17487/RFC7952</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7952">https://www.rfc-editor.org/rfc/rfc7952</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8340">[RFC8340]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M.</span> and <span class="refAuthor">L. Berger, Ed.</span>, <span class="refTitle">"YANG Tree Diagrams"</span>, <span class="seriesInfo">BCP 215</span>, <span class="seriesInfo">RFC 8340</span>, <span class="seriesInfo">DOI 10.17487/RFC8340</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8340">https://www.rfc-editor.org/rfc/rfc8340</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8641">[RFC8641]</dt>
        <dd>
<span class="refAuthor">Clemm, A.</span> and <span class="refAuthor">E. Voit</span>, <span class="refTitle">"Subscription to YANG Notifications for Datastore Updates"</span>, <span class="seriesInfo">RFC 8641</span>, <span class="seriesInfo">DOI 10.17487/RFC8641</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8641">https://www.rfc-editor.org/rfc/rfc8641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8785">[RFC8785]</dt>
        <dd>
<span class="refAuthor">Rundgren, A.</span>, <span class="refAuthor">Jordan, B.</span>, and <span class="refAuthor">S. Erdtman</span>, <span class="refTitle">"JSON Canonicalization Scheme (JCS)"</span>, <span class="seriesInfo">RFC 8785</span>, <span class="seriesInfo">DOI 10.17487/RFC8785</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8785">https://www.rfc-editor.org/rfc/rfc8785</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9052">[RFC9052]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="seriesInfo">STD 96</span>, <span class="seriesInfo">RFC 9052</span>, <span class="seriesInfo">DOI 10.17487/RFC9052</span>, <time datetime="2022-08" class="refDate">August 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9052">https://www.rfc-editor.org/rfc/rfc9052</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9195">[RFC9195]</dt>
        <dd>
<span class="refAuthor">Lengyel, B.</span> and <span class="refAuthor">B. Claise</span>, <span class="refTitle">"A File Format for YANG Instance Data"</span>, <span class="seriesInfo">RFC 9195</span>, <span class="seriesInfo">DOI 10.17487/RFC9195</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9195">https://www.rfc-editor.org/rfc/rfc9195</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9254">[RFC9254]</dt>
        <dd>
<span class="refAuthor">Veillette, M., Ed.</span>, <span class="refAuthor">Petrov, I., Ed.</span>, <span class="refAuthor">Pelov, A.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"Encoding of Data Modeled with YANG in the Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 9254</span>, <span class="seriesInfo">DOI 10.17487/RFC9254</span>, <time datetime="2022-07" class="refDate">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9254">https://www.rfc-editor.org/rfc/rfc9254</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XMLSig">[XMLSig]</dt>
      <dd>
<span class="refTitle">"XML Signature Syntax and Processing Version 2.0"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.w3.org/TR/xmldsig-core2/">https://www.w3.org/TR/xmldsig-core2/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC7223">[RFC7223]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M.</span>, <span class="refTitle">"A YANG Data Model for Interface Management"</span>, <span class="seriesInfo">RFC 7223</span>, <span class="seriesInfo">DOI 10.17487/RFC7223</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7223">https://www.rfc-editor.org/rfc/rfc7223</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="YANGmanifest">[YANGmanifest]</dt>
      <dd>
<span class="refAuthor">Claise, B.</span>, <span class="refAuthor">Quilbeuf, J.</span>, <span class="refAuthor">Lopez, D.</span>, <span class="refAuthor">Martinez-Casanueva, I. D.</span>, and <span class="refAuthor">T. Graf</span>, <span class="refTitle">"A Data Manifest for Contextualized Telemetry Data"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-opsawg-collected-data-manifest-05</span>, <time datetime="2024-10-21" class="refDate">21 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-collected-data-manifest-05">https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-collected-data-manifest-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="appendix-a-examples-of-application-of-the-different-enclosing-methods">
<section id="appendix-A">
      <h2 id="name-appendix-a-examples-of-appl">
<a href="#name-appendix-a-examples-of-appl" class="section-name selfRef">Appendix A. Examples of Application of the Different Enclosing Methods</a>
      </h2>
<div id="xml">
<section id="appendix-A.1">
        <h3 id="name-xml">
<a href="#name-xml" class="section-name selfRef">XML</a>
        </h3>
<p id="appendix-A.1-1">Let us consider the following YANG instance, corresponding to a monitoring interface statement, as defined in <span>[<a href="#RFC7223" class="cite xref">RFC7223</a>]</span>:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;interfaces-state xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"&gt;
    &lt;interface&gt;
        &lt;name&gt;GigabitEthernet1&lt;/name&gt;
        &lt;type xmlns:ianaift="urn:ietf:params:xml:ns:yang:iana-if-type"&gt;
            ianaift:ethernetCsmacd&lt;/type&gt;
        &lt;admin-status&gt;up&lt;/admin-status&gt;
        &lt;oper-status&gt;up&lt;/oper-status&gt;
        &lt;last-change&gt;2024-02-03T11:22:41.081+00:00&lt;/last-change&gt;
        &lt;if-index&gt;1&lt;/if-index&gt;
        &lt;phys-address&gt;0c:00:00:37:d6:00&lt;/phys-address&gt;
        &lt;speed&gt;1000000000&lt;/speed&gt;
        &lt;statistics&gt;
            &lt;discontinuity-time&gt;2024-02-03T11:20:38+00:00&lt;/discontinuity-time&gt;
            &lt;in-octets&gt;8157&lt;/in-octets&gt;
            &lt;in-unicast-pkts&gt;94&lt;/in-unicast-pkts&gt;
            &lt;in-broadcast-pkts&gt;0&lt;/in-broadcast-pkts&gt;
            &lt;in-multicast-pkts&gt;0&lt;/in-multicast-pkts&gt;
            &lt;in-discards&gt;0&lt;/in-discards&gt;
            &lt;in-errors&gt;0&lt;/in-errors&gt;
            &lt;in-unknown-protos&gt;0&lt;/in-unknown-protos&gt;
            &lt;out-octets&gt;89363&lt;/out-octets&gt;
            &lt;out-unicast-pkts&gt;209&lt;/out-unicast-pkts&gt;
            &lt;out-broadcast-pkts&gt;0&lt;/out-broadcast-pkts&gt;
            &lt;out-multicast-pkts&gt;0&lt;/out-multicast-pkts&gt;
            &lt;out-discards&gt;0&lt;/out-discards&gt;
            &lt;out-errors&gt;0&lt;/out-errors&gt;
        &lt;/statistics&gt;
    &lt;/interface&gt;
&lt;/interfaces-state&gt;
</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-3">Applying the first enclosing method, a provenance leaf at the top element (named "signature-string" in this case") would be included and produce the following output:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4">
<pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;interfaces-state xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"&gt;
    &lt;signature-string&gt;
0oRRowNjeG1sBGdlYzIua2V5ASag9lhAvzyFP5HP0nONaqTRxKmSqerrDS6CQXJSK+5NdprzQZLf0QsHtAi2pxzbuDJDy9kZoy1JTvNaJmMxGTLdm4ktug==
    &lt;/signature-string&gt;
    &lt;interface&gt;
        &lt;name&gt;GigabitEthernet1&lt;/name&gt;
        &lt;type xmlns:ianaift="urn:ietf:params:xml:ns:yang:iana-if-type"&gt;
            ianaift:ethernetCsmacd&lt;/type&gt;
        &lt;admin-status&gt;up&lt;/admin-status&gt;
        &lt;oper-status&gt;up&lt;/oper-status&gt;
        &lt;last-change&gt;2024-02-03T11:22:41.081+00:00&lt;/last-change&gt;
        &lt;if-index&gt;1&lt;/if-index&gt;
        &lt;phys-address&gt;0c:00:00:37:d6:00&lt;/phys-address&gt;
        &lt;speed&gt;1000000000&lt;/speed&gt;
        &lt;statistics&gt;
            &lt;discontinuity-time&gt;2024-02-03T11:20:38+00:00&lt;/discontinuity-time&gt;
            &lt;in-octets&gt;8157&lt;/in-octets&gt;
            &lt;in-unicast-pkts&gt;94&lt;/in-unicast-pkts&gt;
            &lt;in-broadcast-pkts&gt;0&lt;/in-broadcast-pkts&gt;
            &lt;in-multicast-pkts&gt;0&lt;/in-multicast-pkts&gt;
            &lt;in-discards&gt;0&lt;/in-discards&gt;
            &lt;in-errors&gt;0&lt;/in-errors&gt;
            &lt;in-unknown-protos&gt;0&lt;/in-unknown-protos&gt;
            &lt;out-octets&gt;89363&lt;/out-octets&gt;
            &lt;out-unicast-pkts&gt;209&lt;/out-unicast-pkts&gt;
            &lt;out-broadcast-pkts&gt;0&lt;/out-broadcast-pkts&gt;
            &lt;out-multicast-pkts&gt;0&lt;/out-multicast-pkts&gt;
            &lt;out-discards&gt;0&lt;/out-discards&gt;
            &lt;out-errors&gt;0&lt;/out-errors&gt;
        &lt;/statistics&gt;
    &lt;/interface&gt;
&lt;/interfaces-state&gt;
</pre><a href="#appendix-A.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-5">The second enclosing method would translate into a notification including the "notification-provenance" element as follows:<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-6">
<pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;notification xmlns="urn:ietf:params:xml:ns:netconf:notification:1.0"&gt;
    &lt;eventTime&gt;2024-02-03T11:37:25.94Z&lt;/eventTime&gt;
    &lt;notification-provenance&gt;
0oRRowNjeG1sBGdlYzIua2V5ASag9lhADiPn3eMRclCAnMlauYyD5yKFvYeXipf4oAmQW5DUREizL59Xs5erOerbryu8vs+A8YOl8AhlAUFzvThffcKPZg==
    &lt;/notification-provenance&gt;
    &lt;push-update xmlns="urn:ietf:params:xml:ns:yang:ietf-yang-push"&gt;
        &lt;subscription-id&gt;2147483648&lt;/subscription-id&gt;
        &lt;datastore-contents-xml&gt;
            &lt;interfaces-state xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"&gt;
                &lt;interface&gt;
                    &lt;name&gt;GigabitEthernet1&lt;/name&gt;
                    &lt;type xmlns:ianaift="urn:ietf:params:xml:ns:yang:iana-if-type"&gt;
                        ianaift:ethernetCsmacd&lt;/type&gt;
                    &lt;admin-status&gt;up&lt;/admin-status&gt;
                    &lt;oper-status&gt;up&lt;/oper-status&gt;
                    &lt;last-change&gt;2024-02-03T11:22:41.081+00:00&lt;/last-change&gt;
                    &lt;if-index&gt;1&lt;/if-index&gt;
                    &lt;phys-address&gt;0c:00:00:37:d6:00&lt;/phys-address&gt;
                    &lt;speed&gt;1000000000&lt;/speed&gt;
                    &lt;statistics&gt;
                        &lt;discontinuity-time&gt;2024-02-03T11:20:38+00:00&lt;/discontinuity-time&gt;
                        &lt;in-octets&gt;8157&lt;/in-octets&gt;
                        &lt;in-unicast-pkts&gt;94&lt;/in-unicast-pkts&gt;
                        &lt;in-broadcast-pkts&gt;0&lt;/in-broadcast-pkts&gt;
                        &lt;in-multicast-pkts&gt;0&lt;/in-multicast-pkts&gt;
                        &lt;in-discards&gt;0&lt;/in-discards&gt;
                        &lt;in-errors&gt;0&lt;/in-errors&gt;
                        &lt;in-unknown-protos&gt;0&lt;/in-unknown-protos&gt;
                        &lt;out-octets&gt;89363&lt;/out-octets&gt;
                        &lt;out-unicast-pkts&gt;209&lt;/out-unicast-pkts&gt;
                        &lt;out-broadcast-pkts&gt;0&lt;/out-broadcast-pkts&gt;
                        &lt;out-multicast-pkts&gt;0&lt;/out-multicast-pkts&gt;
                        &lt;out-discards&gt;0&lt;/out-discards&gt;
                        &lt;out-errors&gt;0&lt;/out-errors&gt;
                    &lt;/statistics&gt;
                &lt;/interface&gt;
            &lt;/interfaces-state&gt;
        &lt;/datastore-contents-xml&gt;
    &lt;/push-update&gt;
&lt;/notification&gt;
</pre><a href="#appendix-A.1-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-7">The third enclosing method, applicable if the instance is to be stored as YANG instance data at rest, by adding the corresponding metadata, would produce a results as shown below:<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-8">
<pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;instance-data-set xmlns="urn:ietf:params:xml:ns:yang:ietf-yang-instance-data"&gt;
  &lt;name&gt;atRestYANG&lt;/name&gt;
  &lt;content-schema&gt;&lt;/content-schema&gt;
  &lt;revision&gt;
    &lt;date&gt;2024-11-03&lt;/date&gt;
    &lt;description&gt;For demos&lt;/description&gt;
  &lt;/revision&gt;
  &lt;description&gt;Sample for demonstrating provenance signatures&lt;/description&gt;
  &lt;contact&gt;diego.r.lopez@telefonica.com&lt;/contact&gt;
  &lt;provenance-string&gt;
0oRRowNjeG1sBGdlYzIua2V5ASag9lhAWff+fMbfNChKUYZ52UTOBmAlYPFe4vlZOLyZeW0CU7/2OutDeMCG28+m3rm58jqLjKbcueKLFq8qFJb4mvPY+Q==
  &lt;/provenance-string&gt;
  &lt;content-data&gt;
   &lt;interfaces-state xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"&gt;
    &lt;interface&gt;
        &lt;name&gt;GigabitEthernet1&lt;/name&gt;
        &lt;type xmlns:ianaift="urn:ietf:params:xml:ns:yang:iana-if-type"&gt;
            ianaift:ethernetCsmacd&lt;/type&gt;
        &lt;admin-status&gt;up&lt;/admin-status&gt;
        &lt;oper-status&gt;up&lt;/oper-status&gt;
        &lt;last-change&gt;2024-02-03T11:22:41.081+00:00&lt;/last-change&gt;
        &lt;if-index&gt;1&lt;/if-index&gt;
        &lt;phys-address&gt;0c:00:00:37:d6:00&lt;/phys-address&gt;
        &lt;speed&gt;1000000000&lt;/speed&gt;
        &lt;statistics&gt;
            &lt;discontinuity-time&gt;2024-02-03T11:20:38+00:00&lt;/discontinuity-time&gt;
            &lt;in-octets&gt;8157&lt;/in-octets&gt;
            &lt;in-unicast-pkts&gt;94&lt;/in-unicast-pkts&gt;
            &lt;in-broadcast-pkts&gt;0&lt;/in-broadcast-pkts&gt;
            &lt;in-multicast-pkts&gt;0&lt;/in-multicast-pkts&gt;
            &lt;in-discards&gt;0&lt;/in-discards&gt;
            &lt;in-errors&gt;0&lt;/in-errors&gt;
            &lt;in-unknown-protos&gt;0&lt;/in-unknown-protos&gt;
            &lt;out-octets&gt;89363&lt;/out-octets&gt;
            &lt;out-unicast-pkts&gt;209&lt;/out-unicast-pkts&gt;
            &lt;out-broadcast-pkts&gt;0&lt;/out-broadcast-pkts&gt;
            &lt;out-multicast-pkts&gt;0&lt;/out-multicast-pkts&gt;
            &lt;out-discards&gt;0&lt;/out-discards&gt;
            &lt;out-errors&gt;0&lt;/out-errors&gt;
        &lt;/statistics&gt;
    &lt;/interface&gt;
   &lt;/interfaces-state&gt;
 &lt;/content-data&gt;
&lt;/instance-data-set&gt;
</pre><a href="#appendix-A.1-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-9">Finally, using the fourth enclosing method, the YANG instance would incorporate the corresponding provenance metadata as an annotation:<a href="#appendix-A.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-10">
<pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;interfaces-state xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"
xmlns:ypmd="http://telefonica.com/temporary-ns-yangpmd"
ypmd:provenance-string=
"0oRRowNjeG1sBGdlYzIua2V5ASag9lhAzen3Bm9AZoyXuetpoTB70SzZqKVxeuOMW099sm+NXSqCfnqBKfXeuqDNEkuEr+E0XiAso986fbAHQCHbAJMOhw=="&gt;
    &lt;interface&gt;
        &lt;name&gt;GigabitEthernet1&lt;/name&gt;
        &lt;type xmlns:ianaift="urn:ietf:params:xml:ns:yang:iana-if-type"&gt;
            ianaift:ethernetCsmacd&lt;/type&gt;
        &lt;admin-status&gt;up&lt;/admin-status&gt;
        &lt;oper-status&gt;up&lt;/oper-status&gt;
        &lt;last-change&gt;2024-02-03T11:22:41.081+00:00&lt;/last-change&gt;
        &lt;if-index&gt;1&lt;/if-index&gt;
        &lt;phys-address&gt;0c:00:00:37:d6:00&lt;/phys-address&gt;
        &lt;speed&gt;1000000000&lt;/speed&gt;
        &lt;statistics&gt;
            &lt;discontinuity-time&gt;2024-02-03T11:20:38+00:00&lt;/discontinuity-time&gt;
            &lt;in-octets&gt;8157&lt;/in-octets&gt;
            &lt;in-unicast-pkts&gt;94&lt;/in-unicast-pkts&gt;
            &lt;in-broadcast-pkts&gt;0&lt;/in-broadcast-pkts&gt;
            &lt;in-multicast-pkts&gt;0&lt;/in-multicast-pkts&gt;
            &lt;in-discards&gt;0&lt;/in-discards&gt;
            &lt;in-errors&gt;0&lt;/in-errors&gt;
            &lt;in-unknown-protos&gt;0&lt;/in-unknown-protos&gt;
            &lt;out-octets&gt;89363&lt;/out-octets&gt;
            &lt;out-unicast-pkts&gt;209&lt;/out-unicast-pkts&gt;
            &lt;out-broadcast-pkts&gt;0&lt;/out-broadcast-pkts&gt;
            &lt;out-multicast-pkts&gt;0&lt;/out-multicast-pkts&gt;
            &lt;out-discards&gt;0&lt;/out-discards&gt;
            &lt;out-errors&gt;0&lt;/out-errors&gt;
        &lt;/statistics&gt;
    &lt;/interface&gt;
&lt;/interfaces-state&gt;
</pre><a href="#appendix-A.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="json">
<section id="appendix-A.2">
        <h3 id="name-json">
<a href="#name-json" class="section-name selfRef">JSON</a>
        </h3>
<p id="appendix-A.2-1">Let us consider the following YANG instance, corresponding to the same monitoring interface statement, with JSON serialization:<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-2">
<pre>
{
  "ietf-interfaces:interfaces-state": {
    "interface": {
      "name": "GigabitEthernet1",
      "iana-if-type:type": "ianaift:ethernetCsmacd",
      "admin-status": "up",
      "oper-status": "up",
      "last-change": "2024-02-03T11:22:41.081+00:00",
      "if-index": 1,
      "phys-address": "0c:00:00:37:d6:00",
      "speed": 1000000000,
      "statistics": {
        "discontinuity-time": "2024-02-03T11:20:38+00:00",
        "in-octets": 8157,
        "in-unicast-pkts": 94,
        "in-broadcast-pkts": 0,
        "in-multicast-pkts": 0,
        "in-discards": 0,
        "in-errors": 0,
        "in-unknown-protos": 0,
        "out-octets": 89363,
        "out-unicast-pkts": 209,
        "out-broadcast-pkts": 0,
        "out-multicast-pkts": 0,
        "out-discards": 0,
        "out-errors": 0
      }
    }
  }
}
</pre><a href="#appendix-A.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-3">Applying the first enclosing method, a provenance leaf at the top element (named "provenance-string" in this case") would be included and produce the following output:<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-4">
<pre>
{
  "ietf-interfaces:interfaces-state" : {
    "interface" : {
      "name" : "GigabitEthernet1",
      "iana-if-type:type" : "ianaift:ethernetCsmacd",
      "admin-status" : "up",
      "oper-status" : "up",
      "last-change" : "2024-02-03T11:22:41.081+00:00",
      "if-index" : 1,
      "phys-address" : "0c:00:00:37:d6:00",
      "speed" : 1000000000,
      "statistics" : {
        "discontinuity-time" : "2024-02-03T11:20:38+00:00",
        "in-octets" : 8157,
        "in-unicast-pkts" : 94,
        "in-broadcast-pkts" : 0,
        "in-multicast-pkts" : 0,
        "in-discards" : 0,
        "in-errors" : 0,
        "in-unknown-protos" : 0,
        "out-octets" : 89363,
        "out-unicast-pkts" : 209,
        "out-broadcast-pkts" : 0,
        "out-multicast-pkts" : 0,
        "out-discards" : 0,
        "out-errors" : 0
      }
    },
    "provenance-string" : "0oRRowNjeG1sBGdlYzIua2V5ASag9lhAnC4dNl5VSxkVCv8IOaiIhD7ymVZJ8Ol1NFH0GZ7bhe+CrnLTOyPazKl2PK33ZqkUGwZo0HmlkPOiAb1okaCZIw=="
  }
}
</pre><a href="#appendix-A.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-5">The second enclosing method would translate into a notification including the "notification-provenance" element. For RESTCONF it would be as follows:<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-6">
<pre>
{
  "ietf-restconf:notification" : {
    "eventTime" : "2013-12-21T00:01:00Z",
    "ietf-yang-push:push-update": {
      "subscription-id": 2147483648,
      "datastore-contents": {
        "ietf-interfaces:interfaces-state": {
          "interface": [ {
              "name": "GigabitEthernet1",
              "type": "ianaift:ethernetCsmacd",
              "admin-status": "up",
              "oper-status": "up",
              "last-change": "2024-02-03T11:22:41.081+00:00",
              "if-index": 1,
              "phys-address": "0c:00:00:37:d6:00",
              "speed": 1000000000,
              "statistics": {
                "discontinuity-time": "2024-02-03T11:20:38+00:00",
                "in-octets": 8157,
                "in-unicast-pkts": 94,
                "in-broadcast-pkts": 0,
                "in-multicast-pkts": 0,
                "in-discards": 0,
                "in-errors": 0,
                "in-unknown-protos": 0,
                "out-octets": 89363,
                "out-unicast-pkts": 209,
                "out-broadcast-pkts": 0,
                "out-multicast-pkts": 0,
                "out-discards": 0,
                "out-errors": 0
              }
            }
          ]
        }
      }
    },
    "notification-provenance" : "0oRRowNjeG1sBGdlYzIua2V5ASag9lhArfYIbXGXjjg5wMF+xJnYGm0NV3ULe2triP4gT7GFeikK19g1N3gNXD5ZZbCn03aN68PgIEl+dglQ6/mobLeEvg=="
  }
}
</pre><a href="#appendix-A.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-7">And for NETCONF:<a href="#appendix-A.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-8">
<pre>
{
  "ietf-notification:notification" : {
    "eventTime" : "2023-02-10T08:00:11.22Z",
    "ietf-yang-push:push-update" : {
      "id" : 1011,
      "datastore-contents" : {
        "ietf-interfaces:interfaces" : [ {
          "interface" : {
            "name": "GigabitEthernet1",
              "iana-if-type:type": "ianaift:ethernetCsmacd",
              "admin-status": "up",
              "oper-status": "up",
              "last-change": "2024-02-03T11:22:41.081+00:00",
              "if-index": 1,
              "phys-address": "0c:00:00:37:d6:00",
              "speed": 1000000000,
              "statistics": {
                "discontinuity-time": "2024-02-03T11:20:38+00:00",
                "in-octets": 8157,
                "in-unicast-pkts": 94,
                "in-broadcast-pkts": 0,
                "in-multicast-pkts": 0,
                "in-discards": 0,
                "in-errors": 0,
                "in-unknown-protos": 0,
                "out-octets": 89363,
                "out-unicast-pkts": 209,
                "out-broadcast-pkts": 0,
                "out-multicast-pkts": 0,
                "out-discards": 0,
                "out-errors": 0
              }
          }
        } ]
      }
    },
    "notification-provenance" : "0oRRowNjeG1sBGdlYzIua2V5ASag9lhAvkE8Y0Od9zRLM/sNlJtau07xuO3zDArCnUhaKJpS6erVUL0MflWm7zby//k4BBQ2zBiBO6LDouoaiuGGj6EwiQ=="
  }
}
</pre><a href="#appendix-A.2-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-9">The third enclosing method, applicable if the instance is to be stored as YANG instance data at rest, by adding the corresponding metadata, would produce a results as shown below:<a href="#appendix-A.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-10">
<pre>
{
  "ietf-yang-instance-data:instance-data-set" : {
    "name" : "interfaces-labTID-status",
    "contact" : "sofia.garciarincon.practicas@telefonica.com",
    "timestamp" : "Thu Jul 18 11:42:06 CEST 2024",
    "content-data" : {
      "ietf-interfaces:interfaces-state": {
        "interface": {
          "name": "GigabitEthernet1",
          "iana-if-type:type": "ianaift:ethernetCsmacd",
          "admin-status": "up",
          "oper-status": "up",
          "last-change": "2024-02-03T11:22:41.081+00:00",
          "if-index": 1,
          "phys-address": "0c:00:00:37:d6:00",
          "speed": 1000000000,
          "statistics": {
            "discontinuity-time": "2024-02-03T11:20:38+00:00",
            "in-octets": 8157,
            "in-unicast-pkts": 94,
            "in-broadcast-pkts": 0,
            "in-multicast-pkts": 0,
            "in-discards": 0,
            "in-errors": 0,
            "in-unknown-protos": 0,
            "out-octets": 89363,
            "out-unicast-pkts": 209,
            "out-broadcast-pkts": 0,
            "out-multicast-pkts": 0,
            "out-discards": 0,
            "out-errors": 0
          }
        }
      }
    },
    "provenance-string" : "0oRRowNjeG1sBGdlYzIua2V5ASag9lhAmop/c7wMcjRmiSPVy65F/N6O21dsGkjGQjIDRizhu3WMwi9Je+VUf5sqwlhSwQCdv5u7mRXa6Pd9dhCwdxdRCA=="
  }
}
</pre><a href="#appendix-A.2-10" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2-11">Finally, using the fourth enclosing method, the YANG instance would incorporate the corresponding provenance metadata as an annotation:<a href="#appendix-A.2-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-12">
<pre>
{
  "ietf-interfaces:interfaces-state" : {
    "interface" : {
      "name" : "GigabitEthernet1",
      "iana-if-type:type" : "ianaift:ethernetCsmacd",
      "admin-status" : "up",
      "oper-status" : "up",
      "last-change" : "2024-02-03T11:22:41.081+00:00",
      "if-index" : 1,
      "phys-address" : "0c:00:00:37:d6:00",
      "speed" : 1000000000,
      "statistics" : {
        "discontinuity-time" : "2024-02-03T11:20:38+00:00",
        "in-octets" : 8157,
        "in-unicast-pkts" : 94,
        "in-broadcast-pkts" : 0,
        "in-multicast-pkts" : 0,
        "in-discards" : 0,
        "in-errors" : 0,
        "in-unknown-protos" : 0,
        "out-octets" : 89363,
        "out-unicast-pkts" : 209,
        "out-broadcast-pkts" : 0,
        "out-multicast-pkts" : 0,
        "out-discards" : 0,
        "out-errors" : 0
      }
    },
    "@ypmd:provenance-string" : "0oRRowNjeG1sBGdlYzIua2V5ASag9lhAM/Dx3HVc4GL91jmuU5nWgcmOPPVpARLJkWo5wwQYvGFJpKMXTkjAtArPp8v6Sl1ZD1qHimKMhAoHLMHVxBtrcA=="
  }
}
</pre><a href="#appendix-A.2-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cbor">
<section id="appendix-A.3">
        <h3 id="name-cbor">
<a href="#name-cbor" class="section-name selfRef">CBOR</a>
        </h3>
<p id="appendix-A.3-1">TBD, as the reference implementation evolves.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">This document is based on work partially funded by the EU H2020 project SPIRS (grant 952622), and the EU Horizon Europe projects PRIVATEER (grant 101096110), HORSE (grant 101096342), MARE (grant 101191436), ACROSS (grant 101097122) and CYBERNEMO (grant 101168182).<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Diego Lopez</span></div>
<div dir="auto" class="left"><span class="org">Telefonica</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:diego.r.lopez@telefonica.com" class="email">diego.r.lopez@telefonica.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Antonio Pastor</span></div>
<div dir="auto" class="left"><span class="org">Telefonica</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:antonio.pastorperales@telefonica.com" class="email">antonio.pastorperales@telefonica.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alex Huang Feng</span></div>
<div dir="auto" class="left"><span class="org">INSA-Lyon</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:alex.huang-feng@insa-lyon.fr" class="email">alex.huang-feng@insa-lyon.fr</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ana Mendez</span></div>
<div dir="auto" class="left"><span class="org">Telefonica</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ana.mendezperez@telefonica.com" class="email">ana.mendezperez@telefonica.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Henk Birkholz</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer SIT</span></div>
<div dir="auto" class="left"><span class="street-address">Rheinstrasse 75</span></div>
<div dir="auto" class="left">
<span class="postal-code">64295</span> <span class="locality">Darmstadt</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:henk.birkholz@sit.fraunhofer.de" class="email">henk.birkholz@sit.fraunhofer.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sofia Garcia</span></div>
<div dir="auto" class="left"><span class="org">UC3M</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:sofia.garciarincon.practicas@telefonica.com" class="email">sofia.garciarincon.practicas@telefonica.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
